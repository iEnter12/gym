# 第三方服务集成文档

## 天气预报API集成

### 选择的API服务
- **服务商**: 易客天气API (tianqiapi.com)
- **免费额度**: 每日300次左右
- **API地址**: `http://v1.yiketianqi.com/free/day`
- **支持功能**: 实况天气、温度、风力风向、空气质量、气压、湿度等

### API参数说明
- `appid`: 用户appid（需要注册获取）
- `appsecret`: 用户appsecret
- `city`: 城市名称（如：哈尔滨）
- `unescape`: 设置为1，直接输出中文

### 响应数据格式
```json
{
    "nums": 226,
    "cityid": "101120101",
    "city": "哈尔滨",
    "date": "2022-05-05",
    "week": "星期四",
    "update_time": "22:38",
    "wea": "多云",
    "wea_img": "yun",
    "tem": "25",
    "tem_day": "30",
    "tem_night": "23",
    "win": "南风",
    "win_speed": "3级",
    "win_meter": "19km/h",
    "air": "53",
    "pressure": "987",
    "humidity": "27%"
}
```

## AI聊天API集成

### 选择的API服务
- **服务商**: Free API (api.a20safe.com)
- **免费额度**: 无限制
- **API地址**: `https://api.a20safe.com/api.php`
- **支持功能**: AI智能问答，基于ChatGLM2-6B模型

### API参数说明
- `api`: 固定值51
- `key`: 平台密钥（需要关注公众号获取）
- `text`: 用户输入的问题

### 响应数据格式
```json
{
    "code": 0,
    "msg": "success",
    "data": [{
        "question": "你是谁",
        "reply": "我是人工智能助手。我的目的是为了回答用户的问题，并且尽可能地帮助用户完成任务。如果你有任何问题，可以随时问我。"
    }]
}
```

## 集成注意事项

### 天气API
1. 需要注册账号获取appid和appsecret
2. 免费版本有请求次数限制（每日300次）
3. 建议实现缓存机制，避免频繁请求
4. 支持按城市名称查询，适合哈尔滨地区使用

### AI聊天API
1. 需要关注公众号获取密钥
2. 响应速度较快，但不支持连续对话
3. 基于ChatGLM2-6B模型，中文支持良好
4. 建议实现会话管理，保存聊天历史

## 实现建议

### 缓存策略
- 天气数据：缓存1小时，减少API调用
- AI聊天：保存聊天历史到数据库

### 错误处理
- API请求失败时使用模拟数据
- 实现重试机制
- 记录错误日志

### 安全考虑
- API密钥存储在环境变量中
- 实现请求频率限制
- 验证用户输入，防止恶意请求

